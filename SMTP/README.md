# SMTP-–∫–ª–∏–µ–Ω—Ç –Ω–∞ C++
**–û—Ç–ø—Ä–∞–≤–∫–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º —Å –≤–ª–æ–∂–µ–Ω–∏—è–º–∏ —á–µ—Ä–µ–∑ SMTP —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π STARTTLS**

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ö–ª–∏–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ **–∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ C++23**, –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–µ:

- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –≤—ã–∑–æ–≤—ã POSIX** (`socket`, `connect`, `read`, `write`) –¥–ª—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é.
- **–ë–∏–±–ª–∏–æ—Ç–µ–∫—É OpenSSL** —á–µ—Ä–µ–∑ CMake-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é (`OpenSSL::SSL`, `OpenSSL::Crypto`) –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ TLS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ `STARTTLS`.
- **RAII-–æ–±—ë—Ä—Ç–∫–∏** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Å–æ–∫–µ—Ç–æ–≤ –∏ SSL-—Ä–µ—Å—É—Ä—Å–æ–≤.
- **MIME-—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä—É—á–Ω—É—é**: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è multipart-—Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ `Content-Type`, `Content-Disposition` –∏ base64-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤–ª–æ–∂–µ–Ω–∏–π.
- **–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π SMTP-–¥–∏–∞–ª–æ–≥**:  
  `220` ‚Üí `EHLO` ‚Üí `STARTTLS` ‚Üí `235` ‚Üí `MAIL FROM` ‚Üí `RCPT TO` ‚Üí `DATA` ‚Üí `QUIT`.

### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤–ª–æ–∂–µ–Ω–∏–π** –ª—é–±–æ–≥–æ —Ç–∏–ø–∞.
- –û–±—Ä–∞–±–æ—Ç–∫–∞ **–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã—Ö SMTP-–æ—Ç–≤–µ—Ç–æ–≤** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `250-...` –ø–æ—Å–ª–µ `EHLO`).
- **–¢–∞–π–º–∞—É—Ç 10 —Å–µ–∫—É–Ω–¥** –Ω–∞ —Å–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –∑–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–≤–∏—Å–∞–Ω–∏–π.
- –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å **Gmail SMTP (–ø–æ—Ä—Ç 587)** –∏ –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º–∏ STARTTLS + `AUTH LOGIN`.

---

## üì° –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π SMTP-—Å–µ—Ä–≤–µ—Ä

–û—Å–Ω–æ–≤–Ω–æ–π —Ü–µ–ª–µ–≤–æ–π —Å–µ—Ä–≤–µ—Ä ‚Äî **Google Gmail SMTP**:

- **–•–æ—Å—Ç**: `smtp.gmail.com`
- **–ü–æ—Ä—Ç**: `587` (STARTTLS)
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: `AUTH LOGIN` —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **App Password**
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞–∫–∫–∞—É–Ω—Ç—É**:
    - –í–∫–ª—é—á–µ–Ω–∞ –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA)
    - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω 16-—Å–∏–º–≤–æ–ª—å–Ω—ã–π **App Password** (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤!)

–ö–ª–∏–µ–Ω—Ç —Ç–∞–∫–∂–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å –¥—Ä—É–≥–∏–º–∏ SMTP-—Å–µ—Ä–≤–µ—Ä–∞–º–∏ (Yandex, Mail.ru –∏ –¥—Ä.), –µ—Å–ª–∏ –æ–Ω–∏:
- –û—Ç–∫—Ä—ã–≤–∞—é—Ç –ø–æ—Ä—Ç 587,
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç STARTTLS,
- –†–∞–∑—Ä–µ—à–∞—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ –ª–æ–≥–∏–Ω—É/–ø–∞—Ä–æ–ª—é.

> ‚ö†Ô∏è –ü–æ—Ä—Ç 25 (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è) –∏ –ø–æ—Ä—Ç 465 (implicit SSL) **–Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è**.

---

## üõ† –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Linux (–∏–ª–∏ WSL –Ω–∞ Windows)
- CMake ‚â• 3.22
- –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++23 (GCC 11+, Clang 15+)
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:
  ```bash
  sudo apt install cmake g++ libssl-dev
  ```

### –°–±–æ—Ä–∫–∞

```bash
cmake -S . -B build
cmake --build build
```

–ò—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª `SMTP` –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –≤ –ø–∞–ø–∫–µ `public/` (—Å–æ–≥–ª–∞—Å–Ω–æ `CMAKE_CURRENT_SOURCE_DIR/public` –≤ `CMakeLists.txt`).

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gmail

1. –í–∫–ª—é—á–∏—Ç–µ [2FA](https://myaccount.google.com/security).
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [App Passwords](https://myaccount.google.com/apppasswords).
3. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è ¬´–ü–æ—á—Ç—ã¬ª ‚Üí ¬´–î—Ä—É–≥–æ–µ¬ª ‚Üí –Ω–∞–∑–æ–≤–∏—Ç–µ `SMTP_CPP`.
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **16 —Å–∏–º–≤–æ–ª–æ–≤ –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤**.

### –ó–∞–ø—É—Å–∫

```bash
cd public
./SMTP \
  --host smtp.gmail.com \
  --port 587 \
  --from your_email@gmail.com \
  --to recipient@example.com \
  --subject "Test" \
  --body "Hello from C++!" \
  --user your_email@gmail.com \
  --pass YOUR_APP_PASSWORD \
  --attach ../path/to/file.txt
```

> üí° –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª—ã –∏–∑ `--attach` –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ —É–∫–∞–∑–∞–Ω–Ω–æ–º—É –ø—É—Ç–∏ **–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏**.
